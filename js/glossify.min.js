var magic_gloss={supports_canvas:function(){return !!document.createElement("canvas").getContext},supports_ToDataURL:function(){if(!this.supports_canvas()){return false}var a=document.createElement("canvas");var b=a.toDataURL("image/png");return(b.indexOf("data:image/png")==0)},hex2rgb:function(b){var a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(b);return a?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:{r:0,g:0,b:0}},rgb_str:function(a,b){return"rgba("+a.r+","+a.g+","+a.b+","+b+")"},main:function(k,g,l){if(!$(k).is("img")){return}l=l||1;var i=this.hex2rgb(g);var c=document.createElement("canvas");var b=c.getContext("2d");var p=k.width;var j=k.height;var m=Math.min(p,j);c.width=m;c.height=m+m/3;b.save();b.beginPath();b.arc(m/2,m/2,m/2,0,Math.PI*2,false);b.clip();try{b.drawImage(k,0,0,p,j)}catch(f){return}b.restore();b.save();var s=b.createRadialGradient(m/3,m/1.2,0,m/2,m/2,m/2);s.addColorStop(0,"rgba(255,255,255,0)");s.addColorStop(1,this.rgb_str(i,0.9*l));b.fillStyle=s;b.beginPath();b.arc(m/2,m/2,m/2,0,Math.PI*2,false);b.fill();b.restore();var e=b.createLinearGradient(m/2,0,m/2,m/2);e.addColorStop(0,this.rgb_str({r:255,g:255,b:255},1*l));e.addColorStop(1,this.rgb_str({r:255,g:255,b:255},0.11*l));b.save();b.scale(1.25,1);b.beginPath();b.arc(m/2.5,m/3.5,m/4,0,2*Math.PI,false);b.restore();b.fillStyle=e;b.fill();var o=m/3;var n=m/1.2;var a=m/7;b.save();var s=b.createRadialGradient(o,n,0,o,n,a);s.addColorStop(0,"rgba(255,255,255,1)");s.addColorStop(1,"rgba(255,255,255,0)");b.fillStyle=s;b.beginPath();b.arc(o,n,a,0,Math.PI*2,false);b.fill();b.restore();var q=function(h,d,u,t,r){b.save();b.globalCompositeOperation="destination-over";b.beginPath();b.fillStyle="#fff";b.translate(d-t,u-r);b.scale(t,r);b.arc(1,1,1,0,2*Math.PI,false);b.shadowColor=h.rgb_str(i,0.5*l);b.shadowBlur=3*m/14;b.shadowOffsetX=0;b.shadowOffsetY=1.5*m/14;b.fill();b.restore()};q(this,m/2,m/1.35,m/2.7,m/4);k.please_glow=false;k.src=c.toDataURL("image/png");k.width=c.width;k.height=c.height}};$(function(){if(!magic_gloss.supports_ToDataURL()){return}$("img[data-gloss]").each(function(a,b){$(b).load(function(){if(this.please_glow!=false){var e=$(b).attr("data-glosscolor");var d=$(b).attr("data-glossalpha");magic_gloss.main(b,e,d)}}).each(function(){if(b.complete){$(b).load()}})})});(function(a){a.fn.glossify=function(b){var d=this;var c={color:"#000000",alpha:1};c=a.extend(c,b||{});this.each(function(e,f){magic_gloss.main(f,c.color,c.alpha)});return this}})(jQuery);